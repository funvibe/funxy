import "lib/test" (testRun, assertEquals)

fun idFn(x: t) -> t {
    x
}

fun swap(pair: (a, b)) -> (b, a) {
    (a, b) = pair
    (b, a)
}

testRun("Generic functions", \ -> {
    assertEquals(42, idFn(42), "Identity Int")
    assertEquals("hello", idFn("hello"), "Identity String")

    t = (1, "a")
    swapped = swap(t)
    assertEquals("a", swapped[0], "Swap 0")
    assertEquals(1, swapped[1], "Swap 1")
})

type alias Box<t> = { value: t }

testRun("Generic record type", \ -> {
    b1: Box<Int> = { value: 10 }
    assertEquals(10, b1.value, "Box Int")

    b2: Box<String> = { value: "hi" }
    assertEquals("hi", b2.value, "Box String")
})

type alias Pair<a, b> = { first: a, second: b }

testRun("Multi-param generic type", \ -> {
    p: Pair<Int, Bool> = { first: 1, second: true }
    assertEquals(1, p.first, "Pair first")
    assertEquals(true, p.second, "Pair second")
})
