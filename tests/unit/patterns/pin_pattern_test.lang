import "lib/test" (*)

testRun("Pin pattern basic match", fun() {
    target = 42
    
    // Match success
    res1 = match 42 {
        ^target -> true
        _ -> false
    }
    assertEquals(true, res1)

    // Match failure
    res2 = match 100 {
        ^target -> true
        _ -> false
    }
    assertEquals(false, res2)
})

testRun("Pin pattern with different types", fun() {
    str = "hello"
    res = match "hello" {
        ^str -> "matched"
        _ -> "failed"
    }
    assertEquals("matched", res)
})

testRun("Pin pattern nested in record", fun() {
    user = { id: 1, name: "Alice" }
    target_id = 1
    
    res = match user {
        { id: ^target_id } -> "found"
        _ -> "not found"
    }
    assertEquals("found", res)
})

testRun("Pin pattern nested in list", fun() {
    list = [1, 2, 3]
    val = 2
    
    res = match list {
        [1, ^val, 3] -> "match"
        _ -> "no match"
    }
    assertEquals("match", res)
})
